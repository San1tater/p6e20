<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026é¦¬å¹´æ˜¥ç¯€æˆèªæ¶ˆæ¶ˆæ¨‚</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Comic Sans MS', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background: url('images/bg.png') no-repeat center center fixed;
            background-size: cover;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }
        
        .container {
            width: 100vw;
            height: 100vh;
            overflow: hidden;
            position: relative;
            display: flex;
            flex-direction: column;
        }
        
        /* å…¥å£é é¢æ¨£å¼ */
        .home-page {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px 20px;
            height: 100%;
            width: 100%;
            background-color: transparent;
        }
        
        .game-title {
            text-align: center;
            margin-bottom: 60px;
        }
        
        .game-title h1 {
            font-size: 4.5rem;
            color: #ff3333;
            margin-bottom: 10px;
            letter-spacing: 3px;
            text-shadow: 
                -2px -2px 0 #ffcc00,
                2px -2px 0 #ffcc00,
                -2px 2px 0 #ffcc00,
                2px 2px 0 #ffcc00,
                0 0 10px rgba(255, 204, 0, 0.5);
            -webkit-text-stroke: 4px #ffcc00;
            text-stroke: 4px #ffcc00;
            font-weight: bold;
            animation: titleGlow 3s infinite alternate;
        }
        
        @keyframes titleGlow {
            0% {
                text-shadow: 
                    -2px -2px 0 #ffcc00,
                    2px -2px 0 #ffcc00,
                    -2px 2px 0 #ffcc00,
                    2px 2px 0 #ffcc00,
                    0 0 10px rgba(255, 204, 0, 0.5);
            }
            100% {
                text-shadow: 
                    -3px -3px 0 #ffcc00,
                    3px -3px 0 #ffcc00,
                    -3px 3px 0 #ffcc00,
                    3px 3px 0 #ffcc00,
                    0 0 20px rgba(255, 204, 0, 0.8);
            }
        }
        
        .game-title h2 {
            font-size: 2.2rem;
            color: #ffffff;
            margin-bottom: 30px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
        }
        
        .year-badge {
            background-color: rgba(255, 204, 0, 0.9);
            color: #ff3333;
            padding: 12px 35px;
            border-radius: 25px;
            font-weight: bold;
            font-size: 2.5rem;
            transform: rotate(-5deg);
            display: inline-block;
            margin-bottom: 30px;
            border: 4px solid #ff6666;
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.3);
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);
        }
        
        .home-buttons {
            display: flex;
            flex-direction: column;
            gap: 35px;
            width: 420px;
            margin-top: 20px;
        }
        
        .home-btn {
            padding: 25px 50px;
            font-size: 2.2rem;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.3);
            border: 3px solid rgba(255, 255, 255, 0.8);
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
        }
        
        .home-btn:hover {
            transform: translateY(-8px) scale(1.05);
            box-shadow: 0 15px 25px rgba(0, 0, 0, 0.4);
        }
        
        #startGameBtn {
            background: linear-gradient(to right, #ff3333, #ff6600);
            color: white;
        }
        
        #startGameBtn:hover {
            background: linear-gradient(to right, #ff6600, #ff3333);
        }
        
        #viewLeaderboardBtn {
            background: linear-gradient(to right, #0066cc, #003366);
            color: white;
        }
        
        #viewLeaderboardBtn:hover {
            background: linear-gradient(to right, #003366, #0066cc);
        }
        
        /* éŠæˆ²é é¢æ¨£å¼ */
        .game-page {
            display: none;
            height: 100%;
            width: 100%;
            flex-direction: column;
            background-color: rgba(255, 255, 255, 0.98);
        }
        
        .header {
            background: linear-gradient(to right, #ff6666, #ff9933);
            color: #fff;
            padding: 10px;
            text-align: center;
            position: relative;
            overflow: hidden;
            min-height: 120px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        .header h1 {
            font-size: 2.5rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            letter-spacing: 1px;
            margin-bottom: 8px;
        }
        
        .level-indicator {
            background-color: #ff9933;
            color: white;
            padding: 8px 20px;
            border-radius: 20px;
            display: inline-block;
            margin-top: 5px;
            font-weight: bold;
            font-size: 1.3rem;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        .game-info {
            display: flex;
            justify-content: space-between;
            padding: 12px 25px;
            background-color: #fff5e6;
            border-bottom: 2px dashed #ff6666;
        }
        
        .score-container, .level-container, .timer-container {
            background-color: #fff;
            padding: 10px 20px;
            border-radius: 50px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            font-weight: bold;
            font-size: 1.3rem;
            color: #ff6666;
            display: flex;
            align-items: center;
        }
        
        .score-container::before {
            content: "ğŸ®";
            margin-right: 8px;
            font-size: 1.5rem;
        }
        
        .level-container::before {
            content: "ğŸ¯";
            margin-right: 8px;
            font-size: 1.5rem;
        }
        
        .timer-container::before {
            content: "â±ï¸";
            margin-right: 8px;
            font-size: 1.5rem;
        }
        
        .timer-container.warning {
            color: #ff3333;
            animation: pulse 1s infinite;
        }
        
        .instructions {
            padding: 12px 25px;
            background-color: #fff9e6;
            text-align: center;
            font-size: 1.2rem;
            color: #555;
            border-bottom: 2px dashed #ff6666;
        }
        
        .instructions span {
            color: #ff6666;
            font-weight: bold;
        }
        
        .game-board {
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1;
            overflow: hidden;
        }
        
        .selected-container {
            background-color: #fff0f0;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            width: 100%;
            min-height: 110px;
            border: 2px solid #ff9999;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.1);
        }
        
        .selected-word {
            display: inline-block;
            font-size: 3rem;
            margin: 0 10px;
            color: #ff6666;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);
        }
        
        .tiles-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
            gap: 12px;
            width: 100%;
            flex: 1;
            margin-bottom: 20px;
            overflow-y: auto;
            padding: 10px;
        }
        
        .tile {
            width: 80px;
            height: 80px;
            background: linear-gradient(145deg, #ffcc00, #ff9933);
            border-radius: 15px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2.2rem;
            font-weight: bold;
            color: #fff;
            cursor: pointer;
            user-select: none;
            box-shadow: 0 6px 10px rgba(0, 0, 0, 0.15);
            transition: all 0.2s;
            border: 3px solid #ff6666;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
            flex-shrink: 0;
        }
        
        .tile:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.2);
            background: linear-gradient(145deg, #ff9933, #ffcc00);
        }
        
        .tile.selected {
            background: linear-gradient(145deg, #ff6666, #ff3333);
            color: white;
            border-color: #cc0000;
            transform: scale(0.95);
        }
        
        .tile.used {
            visibility: hidden;
            opacity: 0;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 10px;
            width: 100%;
        }
        
        button {
            padding: 15px 30px;
            font-size: 1.3rem;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        #submitBtn {
            background: linear-gradient(to right, #33cc33, #009900);
            color: white;
            box-shadow: 0 4px 8px rgba(51, 204, 51, 0.3);
        }
        
        #submitBtn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(51, 204, 51, 0.4);
        }
        
        #submitBtn:disabled {
            background: #cccccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        #resetBtn {
            background: linear-gradient(to right, #3399ff, #0066cc);
            color: white;
            box-shadow: 0 4px 8px rgba(51, 153, 255, 0.3);
        }
        
        #resetBtn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(51, 153, 255, 0.4);
        }
        
        #hintBtn {
            background: linear-gradient(to right, #ff9933, #cc6600);
            color: white;
            box-shadow: 0 4px 8px rgba(255, 153, 51, 0.3);
        }
        
        #hintBtn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(255, 153, 51, 0.4);
        }
        
        .progress-container {
            width: 100%;
            background-color: #f5f5f5;
            border-radius: 10px;
            margin-top: 20px;
            overflow: hidden;
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.1);
        }
        
        .progress-bar {
            height: 20px;
            background: linear-gradient(to right, #ff6666, #ff9933);
            width: 0%;
            border-radius: 10px;
            transition: width 0.5s ease;
        }
        
        .target-container {
            padding: 15px 30px;
            background-color: #fff0f0;
            border-top: 2px dashed #ff6666;
            min-height: 120px;
        }
        
        .target-container h3 {
            color: #ff6666;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            font-size: 1.5rem;
        }
        
        .target-container h3::before {
            content: "ğŸ¯";
            margin-right: 10px;
        }
        
        .target-list {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
        }
        
        .target-item {
            background-color: #fff;
            padding: 10px 18px;
            border-radius: 20px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            font-weight: bold;
            font-size: 1.3rem;
            color: #ff6666;
            border: 1px solid #ff9999;
        }
        
        .target-item.found {
            background-color: #f0fff0;
            color: #33cc33;
            border-color: #99ff99;
            text-decoration: line-through;
        }
        
        /* é—œå¡å®Œæˆå½ˆçª— */
        .level-complete {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.85);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 100;
            flex-direction: column;
            color: white;
            text-align: center;
            padding: 20px;
        }
        
        /* éŠæˆ²çµæŸå½ˆçª—ï¼ˆè¶…æ™‚æˆ–å®Œæˆï¼‰ */
        .game-over {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.85);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 100;
            flex-direction: column;
            color: white;
            text-align: center;
            padding: 20px;
        }
        
        .result-content, .level-complete-content, .timeout-content {
            background: linear-gradient(135deg, #ff6666, #ff9933);
            padding: 50px;
            border-radius: 20px;
            max-width: 800px;
            width: 90%;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.5);
            position: relative;
            overflow: hidden;
        }
        
        .result-content h2, .level-complete-content h2, .timeout-content h2 {
            font-size: 3.5rem;
            margin-bottom: 20px;
            text-shadow: 3px 3px 5px rgba(0, 0, 0, 0.5);
        }
        
        .result-content p, .level-complete-content p, .timeout-content p {
            font-size: 2rem;
            margin-bottom: 30px;
        }
        
        .level-complete-buttons, .result-buttons, .timeout-buttons {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .level-complete-buttons button, .result-buttons button, .timeout-buttons button {
            width: 100%;
            font-size: 1.8rem;
            padding: 20px;
        }
        
        /* æ’è¡Œæ¦œé é¢ */
        .leaderboard-page {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.85);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 200;
            color: white;
            text-align: center;
            padding: 20px;
        }
        
        .leaderboard-content {
            background: linear-gradient(135deg, #d95d5d, #e68a2e);
            padding: 40px;
            border-radius: 20px;
            width: 90%;
            height: 90%;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.4);
            position: relative;
            display: flex;
            flex-direction: column;
        }
        
        .leaderboard-content h2 {
            font-size: 3rem;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.4);
        }
        
        .leaderboard-content h3 {
            font-size: 2.2rem;
            margin: 20px 0 10px;
            color: #ffd966;
        }
        
        .leaderboard-list {
            list-style-type: none;
            margin-bottom: 30px;
            padding: 10px;
            background-color: rgba(0, 0, 0, 0.15);
            border-radius: 10px;
            overflow: hidden;
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        .leaderboard-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 25px;
            background-color: rgba(255, 255, 255, 0.08);
            margin-bottom: 15px;
            border-radius: 10px;
            font-size: 1.8rem;
        }
        
        .leaderboard-item:last-child {
            margin-bottom: 0;
        }
        
        .leaderboard-item.current-player {
            background-color: rgba(51, 153, 255, 0.2);
            border: 2px solid #5ca6ff;
        }
        
        .leaderboard-item:nth-child(1) {
            background-color: rgba(255, 215, 0, 0.2);
            border: 2px solid #ffd700;
        }
        
        .leaderboard-item:nth-child(2) {
            background-color: rgba(192, 192, 192, 0.2);
            border: 2px solid #c0c0c0;
        }
        
        .leaderboard-item:nth-child(3) {
            background-color: rgba(205, 127, 50, 0.2);
            border: 2px solid #cd7f32;
        }
        
        .leaderboard-rank {
            font-weight: bold;
            font-size: 2rem;
            min-width: 50px;
        }
        
        .leaderboard-name {
            flex-grow: 1;
            text-align: left;
            margin-left: 25px;
        }
        
        .leaderboard-score {
            font-weight: bold;
            font-size: 2rem;
            color: #ffd966;
        }
        
        .leaderboard-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-top: 20px;
        }
        
        .leaderboard-form input {
            padding: 20px;
            font-size: 1.5rem;
            border-radius: 10px;
            border: none;
            text-align: center;
            background-color: white;
            color: #333;
        }
        
        .leaderboard-form button {
            padding: 20px;
            font-size: 1.8rem;
        }
        
        #saveScoreBtn {
            background: linear-gradient(to right, #2ca02c, #1e7c1e);
            color: white;
        }
        
        #newGameFromLeaderboardBtn, #viewNewGameBtn {
            background: linear-gradient(to right, #2e8bcc, #1c6ea4);
            color: white;
        }
        
        #backToHomeFromLeaderboardBtn, #viewBackToHomeBtn {
            background: linear-gradient(to right, #6c757d, #545b62);
            color: white;
        }
        
        .firework {
            position: absolute;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            pointer-events: none;
        }
        
        .horse {
            font-size: 6rem;
            position: absolute;
            animation: bounce 2s infinite;
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        .level-up {
            animation: glow 1s infinite alternate;
        }
        
        @keyframes glow {
            from { box-shadow: 0 0 10px #ffeb3b, 0 0 20px #ffeb3b, 0 0 30px #ff9800; }
            to { box-shadow: 0 0 20px #ffeb3b, 0 0 30px #ff9800, 0 0 40px #ff5722; }
        }
        
        .hint-effect {
            animation: hintFlash 0.5s 3;
        }
        
        @keyframes hintFlash {
            0%, 100% { background: linear-gradient(145deg, #ffcc00, #ff9900); }
            50% { background: linear-gradient(145deg, #33cc33, #009900); }
        }
        
        .year2026 {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: #ffcc00;
            color: #ff3333;
            padding: 8px 15px;
            border-radius: 10px;
            font-weight: bold;
            font-size: 1.5rem;
            transform: rotate(10deg);
        }
        
        .empty-leaderboard {
            font-size: 2rem;
            padding: 30px;
            color: #ffd966;
            text-align: center;
        }
        
        .leaderboard-buttons {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-top: 20px;
        }
        
        .back-home-btn {
            background: linear-gradient(to right, #6c757d, #545b62);
            color: white;
        }
        
        .close-leaderboard-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.5);
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 2rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .close-leaderboard-btn:hover {
            background: rgba(0, 0, 0, 0.7);
        }
        
        .player-rank-info {
            font-size: 1.8rem;
            margin: 15px 0;
            padding: 15px;
            background-color: rgba(255, 255, 255, 0.08);
            border-radius: 10px;
        }
        
        .separator {
            height: 2px;
            background-color: rgba(255, 255, 255, 0.15);
            margin: 20px 0;
            width: 100%;
        }
        
        /* éŸ¿æ‡‰å¼èª¿æ•´ */
        @media (max-width: 768px) {
            .tile {
                width: 70px;
                height: 70px;
                font-size: 1.8rem;
            }
            
            .game-title h1 {
                font-size: 3.5rem;
            }
            
            .game-title h2 {
                font-size: 1.8rem;
            }
            
            .home-btn {
                padding: 20px 40px;
                font-size: 1.8rem;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .selected-word {
                font-size: 2.5rem;
            }
            
            .home-buttons {
                width: 350px;
            }
        }
        
        @media (max-width: 480px) {
            .tile {
                width: 60px;
                height: 60px;
                font-size: 1.5rem;
            }
            
            .game-title h1 {
                font-size: 2.8rem;
            }
            
            .year-badge {
                font-size: 2rem;
                padding: 10px 25px;
            }
            
            .selected-word {
                font-size: 2rem;
            }
            
            .home-buttons {
                width: 300px;
            }
            
            .home-btn {
                padding: 18px 35px;
                font-size: 1.6rem;
            }
        }
        
        @media (max-height: 600px) {
            .game-title h1 {
                font-size: 2.5rem;
            }
            
            .game-title h2 {
                font-size: 1.5rem;
            }
            
            .year-badge {
                font-size: 1.8rem;
                padding: 8px 20px;
            }
            
            .home-buttons {
                margin-top: 20px;
                gap: 20px;
            }
            
            .home-btn {
                padding: 15px 30px;
                font-size: 1.5rem;
            }
            
            .tile {
                width: 50px;
                height: 50px;
                font-size: 1.2rem;
            }
            
            .selected-word {
                font-size: 1.8rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- å…¥å£é é¢ -->
        <div class="home-page" id="homePage">
            <div class="game-title">
                <div class="year-badge">2026 ğŸ é¦¬å¹´</div>
                <h1>æˆèªæ¶ˆæ¶ˆæ¨‚</h1>
            </div>
            
            <div class="home-buttons">
                <button class="home-btn" id="startGameBtn">é–‹å§‹é—–é—œ ğŸ®</button>
                <button class="home-btn" id="viewLeaderboardBtn">æ’è¡Œæ¦œ ğŸ†</button>
            </div>
        </div>
        
        <!-- éŠæˆ²é é¢ -->
        <div class="game-page" id="gamePage">
            <div class="header">
                <div class="year2026">2026ğŸ</div>
                <h1>é¦¬å¹´æ˜¥ç¯€æˆèªæ¶ˆæ¶ˆæ¨‚</h1>
                <div class="level-indicator">ç¬¬ <span id="currentLevel">1</span> é—œï¼šæ‰¾ <span id="levelTarget">3</span> å­—è©èª</div>
            </div>
            
            <div class="game-info">
                <div class="score-container">
                    ç´…åŒ…: <span id="score">0</span>
                </div>
                <div class="level-container">
                    é—œå¡: <span id="level">1</span>/5
                </div>
                <div class="timer-container" id="timerContainer">
                    æ™‚é–“: <span id="timer">30</span>ç§’
                </div>
            </div>
            
            <div class="instructions">
                ç©æ³•: é»æ“Šæ¼¢å­—çµ„æˆèˆ‡é¦¬å¹´æ˜¥ç¯€ç›¸é—œçš„è©èªï¼Œæ¯é—œé™æ™‚30ç§’ï¼
            </div>
            
            <div class="game-board">
                <div class="selected-container">
                    <div id="selectedWords"></div>
                </div>
                
                <div class="tiles-container" id="tilesContainer">
                    <!-- æ¼¢å­—æ–¹å¡Šå°‡é€šéJavaScriptå‹•æ…‹ç”Ÿæˆ -->
                </div>
                
                <div class="controls">
                    <button id="submitBtn" disabled>æäº¤è©èª</button>
                    <button id="resetBtn">é‡é¸</button>
                    <button id="hintBtn">æç¤º (3)</button>
                </div>
                
                <div class="progress-container">
                    <div class="progress-bar" id="progressBar"></div>
                </div>
            </div>
            
            <div class="target-container">
                <h3>æœ¬é—œç›®æ¨™è©èª (3å€‹):</h3>
                <div class="target-list" id="targetList">
                    <!-- ç›®æ¨™è©èªå°‡é¡¯ç¤ºåœ¨é€™è£¡ -->
                </div>
            </div>
        </div>
        
        <!-- é—œå¡å®Œæˆå½ˆçª— -->
        <div class="level-complete" id="levelCompleteScreen">
            <div class="level-complete-content">
                <h2 id="levelCompleteTitle">æ­å–œå®Œæˆç¬¬ <span id="completedLevel">1</span> é—œï¼</h2>
                <p id="levelCompleteMessage">ä½ ç²å¾—äº† <span id="currentScore">0</span> å€‹ç´…åŒ…ï¼</p>
                <div class="level-complete-buttons">
                    <button id="nextLevelBtn">ä¸‹ä¸€é—œ</button>
                    <button id="leaderboardBtn" style="background: linear-gradient(to right, #e68a2e, #cc6600);">ç™»ä¸Šæ’è¡Œæ¦œï¼ˆçµæŸéŠæˆ²ï¼‰</button>
                </div>
            </div>
        </div>
        
        <!-- éŠæˆ²çµæŸå½ˆçª—ï¼ˆå®Œæˆæ‰€æœ‰é—œå¡ï¼‰ -->
        <div class="game-over" id="gameOverScreen">
            <div class="result-content">
                <h2 id="resultTitle">æ­å–œé€šé—œï¼ğŸ‰</h2>
                <p id="resultMessage">ä½ å®Œæˆäº†æ‰€æœ‰é—œå¡ï¼Œç¸½å…±ç²å¾— <span id="finalScore">0</span> å€‹ç´…åŒ…ï¼å¤ªæ£’äº†ï¼</p>
                <div class="result-buttons">
                    <button id="restartGameBtn">é‡æ–°é–‹å§‹éŠæˆ²</button>
                    <button id="finalLeaderboardBtn" style="background: linear-gradient(to right, #e68a2e, #cc6600);">ç™»ä¸Šæ’è¡Œæ¦œ</button>
                </div>
            </div>
        </div>
        
        <!-- è¶…æ™‚å½ˆçª— -->
        <div class="game-over" id="timeoutScreen">
            <div class="timeout-content">
                <h2>æ™‚é–“åˆ°ï¼â°</h2>
                <p id="timeoutMessage">ç¬¬ <span id="timeoutLevel">1</span> é—œæ™‚é–“çµæŸï¼Œä½ ç²å¾—äº† <span id="timeoutScore">0</span> å€‹ç´…åŒ…ï¼</p>
                <div class="timeout-buttons">
                    <button id="timeoutLeaderboardBtn" style="background: linear-gradient(to right, #e68a2e, #cc6600);">ç™»ä¸Šæ’è¡Œæ¦œï¼ˆçµæŸéŠæˆ²ï¼‰</button>
                    <button id="backToHomeBtn" class="back-home-btn">è¿”å›ä¸»é </button>
                </div>
            </div>
        </div>
        
        <!-- æ’è¡Œæ¦œé é¢ -->
        <div class="leaderboard-page" id="leaderboardPage">
            <div class="leaderboard-content">
                <button class="close-leaderboard-btn" id="closeLeaderboardBtn">Ã—</button>
                <h2>ğŸ† æ’è¡Œæ¦œ ğŸ†</h2>
                <h3>é¦¬å¹´æ˜¥ç¯€æˆèªé«˜æ‰‹</h3>
                <ul class="leaderboard-list" id="leaderboardList">
                    <!-- æ’è¡Œæ¦œå…§å®¹å°‡å‹•æ…‹ç”Ÿæˆ -->
                </ul>
                
                <!-- å¾ä¸»é é€²å…¥æ™‚é¡¯ç¤ºçš„ç°¡æ½”æŒ‰éˆ•å€åŸŸ -->
                <div class="leaderboard-buttons" id="leaderboardHomeButtons">
                    <button id="viewNewGameBtn">é–‹å§‹æ–°éŠæˆ²</button>
                    <button id="viewBackToHomeBtn" class="back-home-btn">è¿”å›ä¸»é </button>
                </div>
                
                <!-- å¾éŠæˆ²é€²å…¥æ™‚é¡¯ç¤ºçš„ä¿å­˜æˆç¸¾å€åŸŸ -->
                <div id="leaderboardFormContainer" style="display: none;">
                    <h3>è¨˜éŒ„ä½ çš„æˆç¸¾</h3>
                    <p style="margin-bottom: 15px; font-size: 1.5rem;">ä½ ç²å¾—äº† <span id="leaderboardScore">0</span> å€‹ç´…åŒ…ï¼</p>
                    <form class="leaderboard-form" id="leaderboardForm">
                        <input type="text" id="playerName" placeholder="è¼¸å…¥ä½ çš„æš±ç¨±" maxlength="10" required>
                        <div class="leaderboard-buttons">
                            <button type="submit" id="saveScoreBtn">ä¿å­˜æˆç¸¾</button>
                            <button type="button" id="newGameFromLeaderboardBtn">é‡æ–°é–‹å§‹éŠæˆ²</button>
                            <button type="button" id="backToHomeFromLeaderboardBtn" class="back-home-btn">è¿”å›ä¸»é </button>
                        </div>
                    </form>
                </div>
                
                <!-- æˆç¸¾ä¿å­˜å¾Œé¡¯ç¤ºçš„å€åŸŸ -->
                <div id="leaderboardViewOnly" style="display: none;">
                    <div class="leaderboard-buttons">
                        <button id="viewNewGameBtn2">é‡æ–°é–‹å§‹éŠæˆ²</button>
                        <button id="viewBackToHomeBtn2" class="back-home-btn">è¿”å›ä¸»é </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 2026é¦¬å¹´æ˜¥ç¯€ç›¸é—œåˆ†ç´šè©åº« - æ¯é—œ3å€‹è©èª
        const wordLibrary = {
            // ç¬¬ä¸€é—œï¼š2å­—è©èª (3å€‹) - æ˜¥ç¯€ç›¸é—œ
            level1: {
                wordLength: 2,
                words: ["æ˜¥ç¯€", "é¦¬å¹´", "ç´…åŒ…", "é­ç‚®", "ç¦å­—"]
            },
            // ç¬¬äºŒé—œï¼š2å­—è©èª (3å€‹) - é¦¬å¹´ç›¸é—œ
            level2: {
                wordLength: 2,
                words: ["é§¿é¦¬", "é¦¬è¹„", "é¦¬è»Š", "é¦¬é", "é¦¬å…’"]
            },
            // ç¬¬ä¸‰é—œï¼š3å­—è©èª (3å€‹) - æ˜¥ç¯€ç¥ç¦
            level3: {
                wordLength: 3,
                words: ["æ–°å¹´å¥½", "æ­å–œä½ ", "è¬äº‹é †", "å¥½é‹ä¾†", "æ¨‚é–‹æ‡·"]
            },
            // ç¬¬å››é—œï¼š4å­—è©èª (3å€‹) - æ˜¥ç¯€æˆèª
            level4: {
                wordLength: 4,
                words: ["æ–°å¹´å¿«æ¨‚", "è¬äº‹å¦‚æ„", "æ­å–œç™¼è²¡", "é—”å®¶æ­¡æ¨‚"]
            },
            // ç¬¬äº”é—œï¼š4å­—è©èª (3å€‹) - é¦¬å¹´æˆèª
            level5: {
                wordLength: 4,
                words: ["é¦¬åˆ°æˆåŠŸ", "é¾é¦¬ç²¾ç¥", "ä¸€é¦¬ç•¶å…ˆ", "è¬é¦¬å¥”é¨°", "é¦¬å¹´å¤§å‰"]
            }
        };
        
        // éŠæˆ²ç‹€æ…‹
        let gameState = {
            score: 0,
            level: 1,
            selectedTiles: [],
            foundWords: [],
            currentWords: [],
            targetWords: [],
            currentTiles: [],
            gameActive: false,
            hintsLeft: 3,
            isGameComplete: false,
            hasSavedScore: false,
            timeLeft: 30,
            timerInterval: null,
            currentPlayerRank: null,
            currentPlayerEntry: null
        };
        
        // æ’è¡Œæ¦œæ•¸æ“š
        let leaderboard = [];
        
        // DOMå…ƒç´ 
        const homePage = document.getElementById('homePage');
        const gamePage = document.getElementById('gamePage');
        const scoreElement = document.getElementById('score');
        const levelElement = document.getElementById('level');
        const currentLevelElement = document.getElementById('currentLevel');
        const levelTargetElement = document.getElementById('levelTarget');
        const selectedWordsElement = document.getElementById('selectedWords');
        const tilesContainer = document.getElementById('tilesContainer');
        const submitBtn = document.getElementById('submitBtn');
        const resetBtn = document.getElementById('resetBtn');
        const hintBtn = document.getElementById('hintBtn');
        const nextLevelBtn = document.getElementById('nextLevelBtn');
        const restartGameBtn = document.getElementById('restartGameBtn');
        const leaderboardBtn = document.getElementById('leaderboardBtn');
        const finalLeaderboardBtn = document.getElementById('finalLeaderboardBtn');
        const levelCompleteScreen = document.getElementById('levelCompleteScreen');
        const gameOverScreen = document.getElementById('gameOverScreen');
        const timeoutScreen = document.getElementById('timeoutScreen');
        const leaderboardPage = document.getElementById('leaderboardPage');
        const levelCompleteTitle = document.getElementById('levelCompleteTitle');
        const levelCompleteMessage = document.getElementById('levelCompleteMessage');
        const completedLevel = document.getElementById('completedLevel');
        const currentScore = document.getElementById('currentScore');
        const resultTitle = document.getElementById('resultTitle');
        const resultMessage = document.getElementById('resultMessage');
        const finalScore = document.getElementById('finalScore');
        const targetList = document.getElementById('targetList');
        const progressBar = document.getElementById('progressBar');
        const leaderboardList = document.getElementById('leaderboardList');
        const leaderboardHomeButtons = document.getElementById('leaderboardHomeButtons');
        const leaderboardFormContainer = document.getElementById('leaderboardFormContainer');
        const leaderboardViewOnly = document.getElementById('leaderboardViewOnly');
        const startGameBtn = document.getElementById('startGameBtn');
        const viewLeaderboardBtn = document.getElementById('viewLeaderboardBtn');
        const timerElement = document.getElementById('timer');
        const timerContainer = document.getElementById('timerContainer');
        const timeoutMessage = document.getElementById('timeoutMessage');
        const timeoutLevel = document.getElementById('timeoutLevel');
        const timeoutScore = document.getElementById('timeoutScore');
        const timeoutLeaderboardBtn = document.getElementById('timeoutLeaderboardBtn');
        const backToHomeBtn = document.getElementById('backToHomeBtn');
        const closeLeaderboardBtn = document.getElementById('closeLeaderboardBtn');
        const viewNewGameBtn = document.getElementById('viewNewGameBtn');
        const viewBackToHomeBtn = document.getElementById('viewBackToHomeBtn');
        
        // é¡¯ç¤ºä¸»é 
        function showHomePage() {
            homePage.style.display = 'flex';
            gamePage.style.display = 'none';
            levelCompleteScreen.style.display = 'none';
            gameOverScreen.style.display = 'none';
            timeoutScreen.style.display = 'none';
            leaderboardPage.style.display = 'none';
        }
        
        // é¡¯ç¤ºéŠæˆ²é é¢
        function showGamePage() {
            homePage.style.display = 'none';
            gamePage.style.display = 'flex';
            levelCompleteScreen.style.display = 'none';
            gameOverScreen.style.display = 'none';
            timeoutScreen.style.display = 'none';
            leaderboardPage.style.display = 'none';
        }
        
        // é¡¯ç¤ºæ’è¡Œæ¦œé é¢
        function showLeaderboardPage(fromHomePage = false) {
            console.log("é¡¯ç¤ºæ’è¡Œæ¦œé é¢ï¼Œä¾†æº:", fromHomePage ? "ä¸»é " : "éŠæˆ²");
            
            // æ›´æ–°æ’è¡Œæ¦œé¡¯ç¤º
            updateLeaderboardDisplay();
            
            // æ ¹æ“šä¾†æºé¡¯ç¤ºä¸åŒçš„å…§å®¹
            if (fromHomePage) {
                // å¾ä¸»é é€²å…¥ï¼šé¡¯ç¤ºç°¡æ½”çš„æ’è¡Œæ¦œå’ŒæŒ‰éˆ•
                leaderboardHomeButtons.style.display = 'flex';
                leaderboardFormContainer.style.display = 'none';
                leaderboardViewOnly.style.display = 'none';
            } else {
                // å¾éŠæˆ²é€²å…¥ï¼šé¡¯ç¤ºä¿å­˜æˆç¸¾åŠŸèƒ½
                leaderboardHomeButtons.style.display = 'none';
                
                // å¦‚æœå·²ç¶“ä¿å­˜éæœ¬æ¬¡æˆç¸¾ï¼Œåªé¡¯ç¤ºæ’è¡Œæ¦œä¸é¡¯ç¤ºè¼¸å…¥è¡¨å–®
                if (gameState.hasSavedScore) {
                    leaderboardFormContainer.style.display = 'none';
                    leaderboardViewOnly.style.display = 'block';
                } else {
                    leaderboardFormContainer.style.display = 'block';
                    leaderboardViewOnly.style.display = 'none';
                }
            }
            
            // é¡¯ç¤ºæ’è¡Œæ¦œé é¢ï¼Œéš±è—å…¶ä»–æ‰€æœ‰é é¢
            homePage.style.display = 'none';
            gamePage.style.display = 'none';
            levelCompleteScreen.style.display = 'none';
            gameOverScreen.style.display = 'none';
            timeoutScreen.style.display = 'none';
            leaderboardPage.style.display = 'flex';
        }
        
        // åˆå§‹åŒ–éŠæˆ²
        function initGame() {
            console.log("åˆå§‹åŒ–éŠæˆ²");
            
            // é‡ç½®éŠæˆ²ç‹€æ…‹
            gameState.score = 0;
            gameState.level = 1;
            gameState.selectedTiles = [];
            gameState.foundWords = [];
            gameState.hintsLeft = 3;
            gameState.isGameComplete = false;
            gameState.hasSavedScore = false;
            gameState.timeLeft = 30;
            gameState.gameActive = false;
            gameState.currentPlayerRank = null;
            gameState.currentPlayerEntry = null;
            
            // æ¸…é™¤è¨ˆæ™‚å™¨
            if (gameState.timerInterval) {
                clearInterval(gameState.timerInterval);
                gameState.timerInterval = null;
            }
            
            // æ›´æ–°UI
            scoreElement.textContent = '0';
            levelElement.textContent = '1';
            currentLevelElement.textContent = '1';
            timerElement.textContent = '30';
            selectedWordsElement.textContent = '';
            selectedWordsElement.innerHTML = selectedWordsElement.textContent;
            progressBar.style.width = '0%';
            levelCompleteScreen.style.display = 'none';
            gameOverScreen.style.display = 'none';
            timeoutScreen.style.display = 'none';
            hintBtn.textContent = `æç¤º (${gameState.hintsLeft})`;
            hintBtn.disabled = false;
            timerContainer.classList.remove('warning');
            
            // è¼‰å…¥æ’è¡Œæ¦œæ•¸æ“š
            loadLeaderboard();
            
            // è¼‰å…¥ç¬¬ä¸€é—œ
            loadLevel(1);
            
            // é¡¯ç¤ºéŠæˆ²é é¢
            showGamePage();
        }
        
        // è¼‰å…¥é—œå¡
        function loadLevel(level) {
            console.log("è¼‰å…¥é—œå¡:", level);
            
            gameState.level = level;
            gameState.selectedTiles = [];
            gameState.foundWords = [];
            gameState.currentWords = [];
            gameState.targetWords = [];
            gameState.currentTiles = [];
            gameState.gameActive = true;
            gameState.timeLeft = 30;
            
            // ç²å–ç•¶å‰é—œå¡é…ç½®
            const levelConfig = wordLibrary[`level${level}`];
            const wordLength = levelConfig.wordLength;
            
            // æ›´æ–°é—œå¡ä¿¡æ¯
            levelElement.textContent = level;
            currentLevelElement.textContent = level;
            levelTargetElement.textContent = wordLength;
            timerElement.textContent = '30';
            
            // å¾è©åº«ä¸­éš¨æ©Ÿé¸æ“‡3å€‹ç›®æ¨™è©èª
            const targetCount = 3;
            
            // éš¨æ©Ÿé¸æ“‡è©èª
            const shuffledWords = [...levelConfig.words].sort(() => Math.random() - 0.5);
            gameState.targetWords = shuffledWords.slice(0, targetCount);
            
            // å°‡ç›®æ¨™è©èªæ‹†åˆ†æˆå–®å€‹æ¼¢å­—
            let allChars = [];
            gameState.targetWords.forEach(word => {
                allChars.push(...word.split(''));
            });
            
            // æ·»åŠ ä¸€äº›æ˜¥ç¯€ç›¸é—œçš„å¹²æ“¾å­—
            const festivalChars = ["æ˜¥", "ç¯€", "ç¦", "å–œ", "æ¨‚", "å‰", "ç¥¥", "æ…¶", "è³€", "è²¡", "é‹", "æ—º", "ç™¼", "é”", "é †", "åˆ©"];
            const extraChars = 12;
            for (let i = 0; i < extraChars; i++) {
                allChars.push(festivalChars[Math.floor(Math.random() * festivalChars.length)]);
            }
            
            // éš¨æ©Ÿæ‰“äº‚æ¼¢å­—
            gameState.currentTiles = shuffleArray([...allChars]);
            
            // æ›´æ–°UI
            updateTilesDisplay();
            updateSelectedDisplay();
            updateTargetList();
            submitBtn.disabled = true;
            
            // é–‹å§‹è¨ˆæ™‚å™¨
            startTimer();
            
            // é¡¯ç¤ºé—œå¡é–‹å§‹æç¤º
            showLevelStartMessage(level, wordLength, targetCount);
        }
        
        // é–‹å§‹è¨ˆæ™‚å™¨
        function startTimer() {
            // æ¸…é™¤ç¾æœ‰è¨ˆæ™‚å™¨
            if (gameState.timerInterval) {
                clearInterval(gameState.timerInterval);
            }
            
            gameState.timeLeft = 30;
            timerElement.textContent = gameState.timeLeft;
            timerContainer.classList.remove('warning');
            
            // è¨­ç½®è¨ˆæ™‚å™¨
            gameState.timerInterval = setInterval(() => {
                if (!gameState.gameActive) return;
                
                gameState.timeLeft--;
                timerElement.textContent = gameState.timeLeft;
                
                // æœ€å¾Œ10ç§’è­¦å‘Š
                if (gameState.timeLeft <= 10) {
                    timerContainer.classList.add('warning');
                }
                
                // æ™‚é–“åˆ°
                if (gameState.timeLeft <= 0) {
                    clearInterval(gameState.timerInterval);
                    gameState.gameActive = false;
                    showTimeoutScreen();
                }
            }, 1000);
        }
        
        // é¡¯ç¤ºè¶…æ™‚ç•«é¢
        function showTimeoutScreen() {
            timeoutLevel.textContent = gameState.level;
            timeoutScore.textContent = gameState.score;
            timeoutScreen.style.display = 'flex';
            
            // æ¸…é™¤å°é¦¬å‹•ç•«
            document.querySelectorAll('.horse').forEach(horse => horse.remove());
        }
        
        // æ›´æ–°æ¼¢å­—æ–¹å¡Šé¡¯ç¤º
        function updateTilesDisplay() {
            tilesContainer.innerHTML = '';
            
            gameState.currentTiles.forEach((char, index) => {
                const tile = document.createElement('div');
                tile.className = 'tile';
                tile.textContent = char;
                tile.dataset.index = index;
                
                // æª¢æŸ¥é€™å€‹æ¼¢å­—æ˜¯å¦å·²è¢«ä½¿ç”¨
                const isUsed = gameState.foundWords.some(word => {
                    // æª¢æŸ¥é€™å€‹æ¼¢å­—æ˜¯å¦åœ¨å·²æ‰¾åˆ°çš„è©èªä¸­
                    const wordChars = word.split('');
                    return wordChars.includes(char);
                });
                
                if (isUsed) {
                    tile.classList.add('used');
                }
                
                tile.addEventListener('click', () => selectTile(index));
                tilesContainer.appendChild(tile);
            });
        }
        
        // æ›´æ–°å·²é¸æ“‡æ¼¢å­—çš„é¡¯ç¤º
        function updateSelectedDisplay() {
            selectedWordsElement.innerHTML = '';
            
            if (gameState.selectedTiles.length === 0) {
                selectedWordsElement.textContent = '';
                return;
            }
            
            gameState.selectedTiles.forEach(tileIndex => {
                const char = gameState.currentTiles[tileIndex];
                const charElement = document.createElement('span');
                charElement.className = 'selected-word';
                charElement.textContent = char;
                selectedWordsElement.appendChild(charElement);
            });
            
            // å•Ÿç”¨æˆ–ç¦ç”¨æäº¤æŒ‰éˆ•
            const currentLevelConfig = wordLibrary[`level${gameState.level}`];
            submitBtn.disabled = gameState.selectedTiles.length !== currentLevelConfig.wordLength;
        }
        
        // æ›´æ–°ç›®æ¨™è©èªåˆ—è¡¨
        function updateTargetList() {
            targetList.innerHTML = '';
            
            gameState.targetWords.forEach(word => {
                const item = document.createElement('div');
                item.className = 'target-item';
                if (gameState.foundWords.includes(word)) {
                    item.classList.add('found');
                }
                item.textContent = word;
                targetList.appendChild(item);
            });
            
            // æ›´æ–°é€²åº¦æ¢
            const progress = (gameState.foundWords.length / gameState.targetWords.length) * 100;
            progressBar.style.width = `${progress}%`;
        }
        
        // é¸æ“‡æ¼¢å­—æ–¹å¡Š
        function selectTile(index) {
            if (!gameState.gameActive) return;
            
            // æª¢æŸ¥é€™å€‹æ¼¢å­—æ˜¯å¦å·²è¢«ä½¿ç”¨
            const tile = document.querySelector(`.tile[data-index="${index}"]`);
            if (tile.classList.contains('used')) return;
            
            // ç²å–ç•¶å‰é—œå¡è©èªé•·åº¦
            const currentLevelConfig = wordLibrary[`level${gameState.level}`];
            const wordLength = currentLevelConfig.wordLength;
            
            // å¦‚æœå·²ç¶“é¸æ“‡äº†è¶³å¤ çš„æ¼¢å­—ï¼Œå‰‡ä¸å…è¨±å†é¸æ“‡
            if (gameState.selectedTiles.length >= wordLength) return;
            
            // å¦‚æœå·²ç¶“é¸æ“‡äº†é€™å€‹æ¼¢å­—ï¼Œå‰‡å–æ¶ˆé¸æ“‡
            const existingIndex = gameState.selectedTiles.indexOf(index);
            if (existingIndex !== -1) {
                gameState.selectedTiles.splice(existingIndex, 1);
                tile.classList.remove('selected');
            } else {
                // é¸æ“‡é€™å€‹æ¼¢å­—
                gameState.selectedTiles.push(index);
                tile.classList.add('selected');
            }
            
            updateSelectedDisplay();
        }
        
        // æäº¤è©èª
        function submitWord() {
            // ç²å–ç•¶å‰é—œå¡é…ç½®
            const currentLevelConfig = wordLibrary[`level${gameState.level}`];
            const wordLength = currentLevelConfig.wordLength;
            
            if (gameState.selectedTiles.length !== wordLength) return;
            
            // ç²å–é¸æ“‡çš„æ¼¢å­—
            const selectedChars = gameState.selectedTiles.map(index => gameState.currentTiles[index]);
            const selectedWord = selectedChars.join('');
            
            // æª¢æŸ¥æ˜¯å¦æœ‰æ•ˆè©èªä¸”æœªæ‰¾åˆ°é
            if (gameState.targetWords.includes(selectedWord) && 
                !gameState.foundWords.includes(selectedWord)) {
                
                // è©èªæœ‰æ•ˆ
                gameState.foundWords.push(selectedWord);
                
                // æ›´æ–°åˆ†æ•¸ï¼šæ¯æ‰¾åˆ°ä¸€å€‹è©èªå¾—10åˆ†
                gameState.score += 10;
                scoreElement.textContent = gameState.score;
                
                // æ›´æ–°ç›®æ¨™åˆ—è¡¨
                updateTargetList();
                
                // æ¨™è¨˜å·²ä½¿ç”¨çš„æ¼¢å­—
                gameState.selectedTiles.forEach(index => {
                    const tile = document.querySelector(`.tile[data-index="${index}"]`);
                    tile.classList.add('used');
                });
                
                // æ¸…ç©ºé¸æ“‡
                gameState.selectedTiles = [];
                updateSelectedDisplay();
                
                // æ’­æ”¾æˆåŠŸæ•ˆæœ
                showSuccessEffect();
                
                // æª¢æŸ¥æ˜¯å¦å®Œæˆç•¶å‰é—œå¡
                if (gameState.foundWords.length === gameState.targetWords.length) {
                    setTimeout(() => {
                        completeLevel();
                    }, 1000);
                }
            } else {
                // è©èªç„¡æ•ˆï¼Œæ‰£åˆ†ä½†æœ€ä½0åˆ†
                gameState.score = Math.max(0, gameState.score - 5);
                scoreElement.textContent = gameState.score;
                
                // æ¸…ç©ºé¸æ“‡
                gameState.selectedTiles.forEach(index => {
                    const tile = document.querySelector(`.tile[data-index="${index}"]`);
                    tile.classList.remove('selected');
                });
                
                gameState.selectedTiles = [];
                updateSelectedDisplay();
                
                // é¡¯ç¤ºéŒ¯èª¤æç¤º
                showErrorEffect();
            }
        }
        
        // å®Œæˆç•¶å‰é—œå¡
        function completeLevel() {
            gameState.gameActive = false;
            
            // æ¸…é™¤è¨ˆæ™‚å™¨
            if (gameState.timerInterval) {
                clearInterval(gameState.timerInterval);
                gameState.timerInterval = null;
            }
            
            // æ›´æ–°é¡¯ç¤ºçš„åˆ†æ•¸
            currentScore.textContent = gameState.score;
            completedLevel.textContent = gameState.level;
            
            // æª¢æŸ¥æ˜¯å¦æ˜¯æœ€å¾Œä¸€é—œ
            if (gameState.level < 5) {
                // ä¸æ˜¯æœ€å¾Œä¸€é—œï¼Œé¡¯ç¤ºé—œå¡å®Œæˆå½ˆçª—
                levelCompleteScreen.style.display = 'flex';
                
                // æ›´æ–°ä¸‹ä¸€é—œæŒ‰éˆ•æ–‡æœ¬
                nextLevelBtn.textContent = "ä¸‹ä¸€é—œ";
                
                // é¡¯ç¤ºå°é¦¬å‹•ç•«
                const horse = document.createElement('div');
                horse.className = 'horse';
                horse.textContent = 'ğŸ';
                horse.style.left = `${Math.random() * 70 + 15}%`;
                horse.style.bottom = '20%';
                levelCompleteScreen.appendChild(horse);
            } else {
                // æ˜¯æœ€å¾Œä¸€é—œï¼Œé¡¯ç¤ºéŠæˆ²å®Œæˆå½ˆçª—
                gameState.isGameComplete = true;
                finalScore.textContent = gameState.score;
                gameOverScreen.style.display = 'flex';
                
                // é¡¯ç¤ºç…™èŠ±æ•ˆæœå’Œå°é¦¬
                for (let i = 0; i < 20; i++) {
                    setTimeout(() => {
                        const x = Math.random() * window.innerWidth;
                        const y = Math.random() * window.innerHeight;
                        const color = ['#FFD700', '#FF6666', '#33CC33', '#3399FF', '#FF9933'][Math.floor(Math.random() * 5)];
                        
                        createFirework(x, y, color);
                    }, i * 100);
                }
                
                // é¡¯ç¤ºå¤šå€‹å°é¦¬
                for (let i = 0; i < 3; i++) {
                    setTimeout(() => {
                        const horse = document.createElement('div');
                        horse.className = 'horse';
                        horse.textContent = 'ğŸ';
                        horse.style.left = `${Math.random() * 70 + 15}%`;
                        horse.style.bottom = `${Math.random() * 30 + 10}%`;
                        gameOverScreen.appendChild(horse);
                    }, i * 300);
                }
            }
        }
        
        // é¡¯ç¤ºæˆåŠŸæ•ˆæœ
        function showSuccessEffect() {
            // åœ¨é¸æ“‡çš„æ¼¢å­—ä½ç½®é¡¯ç¤ºç…™èŠ±æ•ˆæœ
            gameState.selectedTiles.forEach(index => {
                const tile = document.querySelector(`.tile[data-index="${index}"]`);
                const rect = tile.getBoundingClientRect();
                
                for (let i = 0; i < 3; i++) {
                    createFirework(
                        rect.left + rect.width / 2,
                        rect.top + rect.height / 2,
                        ['#FFD700', '#FF6666', '#33CC33'][i % 3]
                    );
                }
            });
            
            // æ’­æ”¾æˆåŠŸéŸ³æ•ˆï¼ˆè¦–è¦ºåé¥‹ï¼‰
            const gameBoard = document.querySelector('.game-board');
            gameBoard.style.boxShadow = 'inset 0 0 0 5px #33CC33';
            
            setTimeout(() => {
                gameBoard.style.boxShadow = 'none';
            }, 300);
        }
        
        // é¡¯ç¤ºéŒ¯èª¤æ•ˆæœ
        function showErrorEffect() {
            // åœ¨éŠæˆ²å€åŸŸé¡¯ç¤ºç´…è‰²é–ƒçˆæ•ˆæœ
            const gameBoard = document.querySelector('.game-board');
            gameBoard.style.boxShadow = 'inset 0 0 0 5px #FF3333';
            
            setTimeout(() => {
                gameBoard.style.boxShadow = 'none';
            }, 300);
        }
        
        // é¡¯ç¤ºé—œå¡é–‹å§‹è¨Šæ¯
        function showLevelStartMessage(level, wordLength, targetCount) {
            const message = document.createElement('div');
            message.textContent = `ç¬¬ ${level} é—œï¼šæ‰¾å‡º ${targetCount} å€‹ ${wordLength} å­—è©èªï¼Œé™æ™‚30ç§’ï¼`;
            message.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: linear-gradient(135deg, #ff6666, #ff9933);
                color: white;
                padding: 20px 40px;
                border-radius: 10px;
                font-size: 2.5rem;
                font-weight: bold;
                z-index: 1000;
                box-shadow: 0 10px 30px rgba(0,0,0,0.3);
                animation: fadeInOut 2s forwards;
                text-align: center;
            `;
            
            document.body.appendChild(message);
            
            setTimeout(() => {
                message.remove();
            }, 2000);
        }
        
        // æä¾›æç¤º
        function giveHint() {
            if (gameState.hintsLeft <= 0 || !gameState.gameActive) return;
            
            // æ‰¾å‡ºä¸€å€‹æœªæ‰¾åˆ°çš„ç›®æ¨™è©èª
            const unfoundWords = gameState.targetWords.filter(word => !gameState.foundWords.includes(word));
            if (unfoundWords.length === 0) return;
            
            const hintWord = unfoundWords[0];
            const hintChars = hintWord.split('');
            
            // æ‰¾åˆ°é€™äº›æ¼¢å­—åœ¨æ–¹å¡Šä¸­çš„ä½ç½®
            const hintIndices = [];
            for (let i = 0; i < hintChars.length; i++) {
                const char = hintChars[i];
                // å°‹æ‰¾æœªä½¿ç”¨çš„åŒ…å«è©²å­—ç¬¦çš„æ–¹å¡Š
                for (let j = 0; j < gameState.currentTiles.length; j++) {
                    if (gameState.currentTiles[j] === char && 
                        !gameState.foundWords.some(word => word.includes(char)) &&
                        !hintIndices.includes(j)) {
                        hintIndices.push(j);
                        break;
                    }
                }
            }
            
            // é«˜äº®é¡¯ç¤ºæç¤ºçš„æ–¹å¡Š
            hintIndices.forEach(index => {
                const tile = document.querySelector(`.tile[data-index="${index}"]`);
                if (tile && !tile.classList.contains('used')) {
                    tile.classList.add('hint-effect');
                    setTimeout(() => {
                        tile.classList.remove('hint-effect');
                    }, 1500);
                }
            });
            
            // æ¸›å°‘æç¤ºæ¬¡æ•¸
            gameState.hintsLeft--;
            hintBtn.textContent = `æç¤º (${gameState.hintsLeft})`;
            
            if (gameState.hintsLeft <= 0) {
                hintBtn.disabled = true;
            }
        }
        
        // å‰µå»ºç…™èŠ±æ•ˆæœ
        function createFirework(x, y, color) {
            const firework = document.createElement('div');
            firework.className = 'firework';
            firework.style.left = `${x}px`;
            firework.style.top = `${y}px`;
            firework.style.backgroundColor = color;
            
            document.body.appendChild(firework);
            
            // ç…™èŠ±çˆ†ç‚¸æ•ˆæœ
            const particles = 12;
            for (let i = 0; i < particles; i++) {
                const angle = (i / particles) * Math.PI * 2;
                const velocity = 2 + Math.random() * 3;
                
                const particle = document.createElement('div');
                particle.className = 'firework';
                particle.style.left = `${x}px`;
                particle.style.top = `${y}px`;
                particle.style.backgroundColor = color;
                particle.style.width = '6px';
                particle.style.height = '6px';
                
                document.body.appendChild(particle);
                
                // ç²’å­å‹•ç•«
                const animation = particle.animate([
                    { transform: 'translate(0, 0)', opacity: 1 },
                    { 
                        transform: `translate(${Math.cos(angle) * velocity * 50}px, ${Math.sin(angle) * velocity * 50}px)`, 
                        opacity: 0 
                    }
                ], {
                    duration: 800,
                    easing: 'cubic-bezier(0.1, 0.8, 0.2, 1)'
                });
                
                animation.onfinish = () => particle.remove();
            }
            
            // ç§»é™¤ä¸­å¿ƒç…™èŠ±
            setTimeout(() => {
                firework.remove();
            }, 100);
        }
        
        // è¼‰å…¥æ’è¡Œæ¦œæ•¸æ“š
        function loadLeaderboard() {
            const savedLeaderboard = localStorage.getItem('horseSpringLeaderboard');
            if (savedLeaderboard) {
                try {
                    leaderboard = JSON.parse(savedLeaderboard);
                } catch (e) {
                    console.error('è¼‰å…¥æ’è¡Œæ¦œæ•¸æ“šå¤±æ•—:', e);
                    leaderboard = [];
                }
            } else {
                leaderboard = [];
            }
        }
        
        // ä¿å­˜æ’è¡Œæ¦œæ•¸æ“š
        function saveLeaderboard() {
            try {
                localStorage.setItem('horseSpringLeaderboard', JSON.stringify(leaderboard));
            } catch (e) {
                console.error('ä¿å­˜æ’è¡Œæ¦œæ•¸æ“šå¤±æ•—:', e);
            }
        }
        
        // æ›´æ–°æ’è¡Œæ¦œé¡¯ç¤º
        function updateLeaderboardDisplay() {
            leaderboardList.innerHTML = '';
            
            if (leaderboard.length === 0) {
                const emptyItem = document.createElement('li');
                emptyItem.className = 'empty-leaderboard';
                emptyItem.textContent = 'æ’è¡Œæ¦œé‚„æ˜¯ç©ºçš„ï¼Œå¿«ä¾†æˆç‚ºç¬¬ä¸€å€‹ä¸Šæ¦œçš„ç©å®¶å§ï¼';
                leaderboardList.appendChild(emptyItem);
                return;
            }
            
            // æŒ‰åˆ†æ•¸æ’åºï¼ˆå¾é«˜åˆ°ä½ï¼‰
            const sortedLeaderboard = [...leaderboard].sort((a, b) => b.score - a.score);
            
            // åªå–å‰ä¸‰å
            const top3 = sortedLeaderboard.slice(0, 3);
            
            // é¡¯ç¤ºå‰ä¸‰å
            top3.forEach((player, index) => {
                const item = document.createElement('li');
                item.className = 'leaderboard-item';
                
                const rank = document.createElement('div');
                rank.className = 'leaderboard-rank';
                
                // å‰ä¸‰åä½¿ç”¨çç‰Œemoji
                if (index === 0) rank.textContent = 'ğŸ¥‡';
                else if (index === 1) rank.textContent = 'ğŸ¥ˆ';
                else if (index === 2) rank.textContent = 'ğŸ¥‰';
                
                const name = document.createElement('div');
                name.className = 'leaderboard-name';
                name.textContent = player.name || 'åŒ¿åç©å®¶';
                
                const score = document.createElement('div');
                score.className = 'leaderboard-score';
                score.textContent = `${player.score} ğŸ®`;
                
                item.appendChild(rank);
                item.appendChild(name);
                item.appendChild(score);
                
                leaderboardList.appendChild(item);
            });
        }
        
        // å·¥å…·å‡½æ•¸ï¼šéš¨æ©Ÿæ‰“äº‚æ•¸çµ„
        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }
        
        // äº‹ä»¶ç›£è½
        submitBtn.addEventListener('click', submitWord);
        
        resetBtn.addEventListener('click', () => {
            gameState.selectedTiles.forEach(index => {
                const tile = document.querySelector(`.tile[data-index="${index}"]`);
                tile.classList.remove('selected');
            });
            
            gameState.selectedTiles = [];
            updateSelectedDisplay();
        });
        
        hintBtn.addEventListener('click', giveHint);
        
        nextLevelBtn.addEventListener('click', () => {
            // æ¸…é™¤å°é¦¬å‹•ç•«
            document.querySelectorAll('.horse').forEach(horse => horse.remove());
            levelCompleteScreen.style.display = 'none';
            loadLevel(gameState.level + 1);
        });
        
        restartGameBtn.addEventListener('click', () => {
            // æ¸…é™¤å°é¦¬å‹•ç•«
            document.querySelectorAll('.horse').forEach(horse => horse.remove());
            gameOverScreen.style.display = 'none';
            initGame();
        });
        
        // é—œå¡å®Œæˆå¾Œçš„æ’è¡Œæ¦œæŒ‰éˆ•ï¼ˆçµæŸéŠæˆ²ï¼‰
        leaderboardBtn.addEventListener('click', () => {
            console.log("é—œå¡å®Œæˆå¾Œé»æ“Šæ’è¡Œæ¦œæŒ‰éˆ•");
            showLeaderboardPage(false);
        });
        
        // éŠæˆ²å®Œæˆå¾Œçš„æ’è¡Œæ¦œæŒ‰éˆ•
        finalLeaderboardBtn.addEventListener('click', () => {
            console.log("éŠæˆ²å®Œæˆå¾Œé»æ“Šæ’è¡Œæ¦œæŒ‰éˆ•");
            showLeaderboardPage(false);
        });
        
        // è¶…æ™‚å¾Œçš„æ’è¡Œæ¦œæŒ‰éˆ•
        timeoutLeaderboardBtn.addEventListener('click', () => {
            console.log("è¶…æ™‚å¾Œé»æ“Šæ’è¡Œæ¦œæŒ‰éˆ•");
            showLeaderboardPage(false);
        });
        
        // è¶…æ™‚å¾Œè¿”å›ä¸»é æŒ‰éˆ•
        backToHomeBtn.addEventListener('click', () => {
            showHomePage();
        });
        
        // ä¸»é æŒ‰éˆ•
        startGameBtn.addEventListener('click', () => {
            console.log("é»æ“Šé–‹å§‹éŠæˆ²æŒ‰éˆ•");
            initGame();
        });
        
        viewLeaderboardBtn.addEventListener('click', () => {
            console.log("é»æ“Šä¸»é æ’è¡Œæ¦œæŒ‰éˆ•");
            showLeaderboardPage(true);
        });
        
        // é—œé–‰æ’è¡Œæ¦œæŒ‰éˆ•
        closeLeaderboardBtn.addEventListener('click', () => {
            showHomePage();
        });
        
        // æ’è¡Œæ¦œé é¢çš„é–‹å§‹æ–°éŠæˆ²æŒ‰éˆ•
        viewNewGameBtn.addEventListener('click', () => {
            leaderboardPage.style.display = 'none';
            initGame();
        });
        
        // æ’è¡Œæ¦œé é¢çš„è¿”å›ä¸»é æŒ‰éˆ•
        viewBackToHomeBtn.addEventListener('click', () => {
            showHomePage();
        });
        
        // æ·»åŠ CSSå‹•ç•«
        const style = document.createElement('style');
        style.textContent = `
            @keyframes fadeInOut {
                0% { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
                20% { opacity: 1; transform: translate(-50%, -50%) scale(1.1); }
                80% { opacity: 1; transform: translate(-50%, -50%) scale(1.1); }
                100% { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
            }
        `;
        document.head.appendChild(style);
        
        // åˆå§‹é¡¯ç¤ºä¸»é 
        showHomePage();
        loadLeaderboard();
        
        // æ¸¬è©¦ç”¨ï¼šç¢ºä¿æ‰€æœ‰æŒ‰éˆ•éƒ½æœ‰äº‹ä»¶ç›£è½
        console.log("é é¢åŠ è¼‰å®Œæˆï¼ŒæŒ‰éˆ•ç‹€æ…‹:");
        console.log("startGameBtn:", startGameBtn);
        console.log("viewLeaderboardBtn:", viewLeaderboardBtn);
        console.log("leaderboardBtn:", leaderboardBtn);
        console.log("finalLeaderboardBtn:", finalLeaderboardBtn);
        console.log("timeoutLeaderboardBtn:", timeoutLeaderboardBtn);
    </script>
</body>
</html>
